{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/HassaanGhayas/physical-ai-robotics-textbook/schemas/code-review-report.json",
  "title": "Code Review Report",
  "description": "Schema for automated code review reports generated by linters and formatters (ESLint, Prettier, Ruff, Black)",
  "version": "1.0.0",
  "type": "object",
  "required": [
    "report_id",
    "commit_sha",
    "tool_name",
    "tool_version",
    "status",
    "issue_count",
    "issues",
    "execution_time_ms",
    "created_at"
  ],
  "properties": {
    "report_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this review report",
      "examples": [
        "a7b8c9d0-1234-5678-90ab-cdef12345678"
      ]
    },
    "commit_sha": {
      "type": "string",
      "pattern": "^[a-f0-9]{40}$",
      "description": "Git commit SHA that was reviewed (full 40-character hash)",
      "examples": [
        "088573c4a5d1e3b7f9c2d4e6a8b0c1d2e3f4a5b6"
      ]
    },
    "commit_message": {
      "type": "string",
      "description": "First line of commit message (for context)",
      "examples": [
        "feat: add sticky table of contents"
      ]
    },
    "tool_name": {
      "type": "string",
      "enum": [
        "ESLint",
        "Prettier",
        "Ruff",
        "Black",
        "TypeScript",
        "Pylint",
        "Mypy"
      ],
      "description": "Name of the code review tool that generated this report"
    },
    "tool_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the tool (major.minor.patch)",
      "examples": [
        "8.52.0",
        "3.1.0",
        "0.1.9"
      ]
    },
    "status": {
      "type": "string",
      "enum": [
        "pass",
        "fail",
        "error"
      ],
      "description": "Overall result of the code review: pass (no issues), fail (issues found), error (tool crashed)"
    },
    "issue_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of issues found (0 if status is 'pass')"
    },
    "issues": {
      "type": "array",
      "description": "List of specific issues found during review (empty array if no issues)",
      "items": {
        "type": "object",
        "required": [
          "file_path",
          "line",
          "severity",
          "message",
          "rule"
        ],
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Relative path to the file containing the issue",
            "examples": [
              "src/pages/index.tsx",
              "backend/api.py"
            ]
          },
          "line": {
            "type": "integer",
            "minimum": 1,
            "description": "Line number where the issue occurs"
          },
          "column": {
            "type": "integer",
            "minimum": 1,
            "description": "Column number where the issue occurs (optional)"
          },
          "severity": {
            "type": "string",
            "enum": [
              "error",
              "warning",
              "info"
            ],
            "description": "Severity level: error (blocks deployment), warning (should fix), info (informational)"
          },
          "message": {
            "type": "string",
            "description": "Human-readable description of the issue",
            "examples": [
              "Missing semicolon",
              "Unused variable 'count'",
              "Line too long (120 > 88 characters)"
            ]
          },
          "rule": {
            "type": "string",
            "description": "Rule identifier or code that was violated",
            "examples": [
              "semi",
              "no-unused-vars",
              "E501",
              "react-hooks/rules-of-hooks"
            ]
          },
          "rule_url": {
            "type": "string",
            "format": "uri",
            "description": "URL to documentation for this rule (optional)",
            "examples": [
              "https://eslint.org/docs/rules/semi",
              "https://docs.astral.sh/ruff/rules/line-too-long/"
            ]
          },
          "suggested_fix": {
            "type": "string",
            "description": "Suggested code fix or remediation steps (optional)",
            "examples": [
              "Add semicolon at end of line",
              "Remove unused variable or use it",
              "Split line into multiple lines or increase line length limit"
            ]
          },
          "code_snippet": {
            "type": "string",
            "description": "Code snippet showing the problematic line (optional)",
            "examples": [
              "const count = 42"
            ]
          }
        },
        "additionalProperties": false
      }
    },
    "execution_time_ms": {
      "type": "integer",
      "minimum": 0,
      "description": "Time taken to run the review in milliseconds",
      "examples": [
        1250,
        450
      ]
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the review completed (UTC)",
      "examples": [
        "2025-12-19T10:31:30Z"
      ]
    },
    "repository": {
      "type": "object",
      "description": "Repository metadata (optional)",
      "properties": {
        "owner": {
          "type": "string",
          "examples": [
            "HassaanGhayas"
          ]
        },
        "name": {
          "type": "string",
          "examples": [
            "physical-ai-robotics-textbook"
          ]
        },
        "url": {
          "type": "string",
          "format": "uri",
          "examples": [
            "https://github.com/HassaanGhayas/physical-ai-robotics-textbook"
          ]
        }
      }
    },
    "workflow": {
      "type": "object",
      "description": "GitHub Actions workflow metadata (optional)",
      "properties": {
        "run_id": {
          "type": "string",
          "description": "GitHub Actions run ID",
          "examples": [
            "7654321098"
          ]
        },
        "run_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to the GitHub Actions run",
          "examples": [
            "https://github.com/HassaanGhayas/physical-ai-robotics-textbook/actions/runs/7654321098"
          ]
        },
        "actor": {
          "type": "string",
          "description": "User who triggered the workflow",
          "examples": [
            "HassaanGhayas",
            "github-actions[bot]"
          ]
        }
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "report_id": "a7b8c9d0-1234-5678-90ab-cdef12345678",
      "commit_sha": "088573c4a5d1e3b7f9c2d4e6a8b0c1d2e3f4a5b6",
      "commit_message": "feat: add sticky table of contents",
      "tool_name": "ESLint",
      "tool_version": "8.52.0",
      "status": "fail",
      "issue_count": 2,
      "issues": [
        {
          "file_path": "src/pages/index.tsx",
          "line": 15,
          "column": 8,
          "severity": "error",
          "message": "Missing semicolon",
          "rule": "semi",
          "rule_url": "https://eslint.org/docs/rules/semi",
          "suggested_fix": "Add semicolon at end of line",
          "code_snippet": "const count = 42"
        },
        {
          "file_path": "src/components/ChatBot/ChatBot.tsx",
          "line": 42,
          "column": 12,
          "severity": "warning",
          "message": "Unused variable 'count'",
          "rule": "no-unused-vars",
          "rule_url": "https://eslint.org/docs/rules/no-unused-vars",
          "suggested_fix": "Remove unused variable or use it"
        }
      ],
      "execution_time_ms": 1250,
      "created_at": "2025-12-19T10:31:30Z",
      "repository": {
        "owner": "HassaanGhayas",
        "name": "physical-ai-robotics-textbook",
        "url": "https://github.com/HassaanGhayas/physical-ai-robotics-textbook"
      },
      "workflow": {
        "run_id": "7654321098",
        "run_url": "https://github.com/HassaanGhayas/physical-ai-robotics-textbook/actions/runs/7654321098",
        "actor": "HassaanGhayas"
      }
    },
    {
      "report_id": "b1c2d3e4-5678-90ab-cdef-1234567890ab",
      "commit_sha": "088573c4a5d1e3b7f9c2d4e6a8b0c1d2e3f4a5b6",
      "commit_message": "feat: add sticky table of contents",
      "tool_name": "Ruff",
      "tool_version": "0.1.9",
      "status": "pass",
      "issue_count": 0,
      "issues": [],
      "execution_time_ms": 450,
      "created_at": "2025-12-19T10:31:45Z",
      "repository": {
        "owner": "HassaanGhayas",
        "name": "physical-ai-robotics-textbook",
        "url": "https://github.com/HassaanGhayas/physical-ai-robotics-textbook"
      },
      "workflow": {
        "run_id": "7654321098",
        "run_url": "https://github.com/HassaanGhayas/physical-ai-robotics-textbook/actions/runs/7654321098",
        "actor": "HassaanGhayas"
      }
    }
  ]
}
